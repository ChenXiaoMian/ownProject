function tempListInit(a){store.get(a)&&!isEmpty(JSON.parse(store.get(a)).data)?(loadTemplateStore(a),$("#templateListEmpty").hide(),$("#btnNewTempWrap").show(),$("#templateList").show()):($("#templateListEmpty").show(),$("#btnNewTempWrap").hide(),$("#templateList").hide())}function loadTemplateStore(a){var b="",c=JSON.parse(store.get(a));$.each(c.data,function(a,c){1==c.IsDefault?b+='<div class="weui-cell"><div class="weui-cell__bd">'+c.tempTitle+'<span>默认</span></div><div class="weui-cell__opa"><a href="javascript:;" data-id="'+c.tid+'" class="doTempEdit" class="c-999999"><i class="iconfont icon-edit"></i> 编辑</a></div><div class="weui-cell__opa"><a href="javascript:;" class="doTempDel" data-id="'+c.tid+'" class="c-999999"><i class="iconfont icon-delete"></i> 删除</a></div></div>':b+='<div class="weui-cell"><div class="weui-cell__bd">'+c.tempTitle+'</div><div class="weui-cell__opa"><a href="javascript:;" data-id="'+c.tid+'" class="doTempEdit" class="c-999999"><i class="iconfont icon-edit"></i> 编辑</a></div><div class="weui-cell__opa"><a href="javascript:;" class="doTempDel" data-id="'+c.tid+'" class="c-999999"><i class="iconfont icon-delete"></i> 删除</a></div></div>'}),$("#templateList").html(b)}$(function(){function a(a,b){var c=JSON.parse(store.get(a)),d=0;return $.each(c.data,function(a,c){c.tid==b&&(d=a)}),c.data.splice(d,1),store.remove(a),store.set(a,JSON.stringify(c)),!0}innerInit();var b=($("#templateList"),$("#templateListEmpty"),store.get("chooseTemp")?store.get("chooseTemp"):"");tempListInit(b),$(".tempList").on("click",".doTempDel",function(){var c=$(this).data("id");weui.confirm("确定删除该模板？",function(){a(b,c)&&(tempListInit(b),weui.toast("删除成功",500))})}),$(".tempList").on("click",".doTempEdit",function(){var a=$(this).data("id");store.set("editTemp",a),window.pageManager.go(b)}),$("#btnNewTemp,#btnNewTemp2").on("click",function(){if(store.remove("editTemp"),store.get(b)&&""!=store.get(b)){JSON.parse(store.get(b)).data.length>=20?weui.alert("创建最多20个模板"):window.pageManager.go(b)}else window.pageManager.go(b)})}),$(window).on("hashchange",function(){var a=store.get("chooseTemp")?store.get("chooseTemp"):"";a&&""!=a&&tempListInit(a)});